<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‹•è©è¾æ›¸ãƒ“ãƒ¥ãƒ¼ã‚¢</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ³ãƒˆã¨åŸºæœ¬è¨­å®š */
        body {
            font-family: 'Hiragino Sans', 'Meiryo', 'Yu Gothic', sans-serif;
            color: #000;
            line-height: 1.6;
            background-color: #f7f7f7;
            min-height: 100vh;
        }
        
        /* è¾æ›¸ã‚«ãƒ¼ãƒ‰ã®åŸºæœ¬ã‚¹ã‚¿ã‚¤ãƒ« */
        .verb-card {
            background-color: #fff;
            padding: 20px 30px;
            margin-bottom: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }

        /* 1. ãƒ˜ãƒƒãƒ€ãƒ¼ (å˜èª) */
        .card-header h3 {
            font-size: 2.2em;
            font-weight: 500;
            margin: 0 0 5px 0;
            display: inline-block;
            border-bottom: 2px solid #000; /* ã‚¿ã‚¤ãƒˆãƒ«ã®ä¸‹ç·š */
            padding-bottom: 3px;
        }
        /* æ´¾ç”Ÿæƒ…å ± (æ¥é ­è¾ + åŸºå¹¹) */
        .etymology {
            font-size: 1.1em;
            color: #007bff; /* é’ç³»ã®è‰² */
            font-style: italic;
            margin-top: 5px;
            font-weight: 500;
        }

        /* 2. æ„å‘³ */
        .meaning-jp {
            font-size: 1.4em;
            font-weight: 700;
            margin: 25px 0 3px 0;
            color: #333;
        }
        .meaning-en {
            font-style: italic;
            font-size: 1em;
            color: #666;
            margin-bottom: 25px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        /* 3. è©³ç´°æƒ…å ± */
        .detail-item {
            display: flex;
            margin-bottom: 6px;
        }
        .detail-label {
            width: 100px; /* ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’æƒãˆã‚‹ãŸã‚ã®å›ºå®šå¹… */
            font-weight: normal;
            margin-right: 15px;
            color: #333;
            flex-shrink: 0;
        }
        .detail-value {
            flex-grow: 1;
            font-size: 0.95em;
        }
        .german-term {
            font-family: 'Consolas', 'Courier New', monospace;
            font-style: italic;
            background-color: #fcfcfc;
            padding: 1px 3px;
            border-radius: 3px;
        }
        .highlight-detail {
            color: #007bff;
            font-weight: 500;
        }

        /* 4. ä¾‹æ–‡ */
        .example-section {
            margin-top: 30px;
            padding-top: 10px;
            border-top: 1px dashed #ddd;
        }
        .example-box {
            display: flex;
            margin-bottom: 20px;
            align-items: flex-start;
        }
        .vertical-line {
            border-left: 2px solid #007bff; /* ä¾‹æ–‡ã®å·¦å´ã®é’ã„ç¸¦ç·š */
            height: auto;
            margin-right: 15px;
            min-height: 2.5em; 
            border-radius: 1px;
            flex-shrink: 0;
        }
        .example-content {
            flex-grow: 1;
        }
        .german-sentence {
            font-weight: normal;
            margin: 0;
            font-size: 1.05em;
        }
        .japanese-translation {
            font-size: 0.9em;
            color: #555;
            margin: 0;
            line-height: 1.2;
            font-style: italic;
        }

        /* 5. æ´¾ç”Ÿèª/é–¢é€£èª */
        .related-section {
            margin-top: 25px;
            border-top: 1px solid #eee;
            padding-top: 15px;
        }
        .related-item {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
            font-size: 0.95em;
        }
        .icon {
            font-size: 1.3em;
            color: #007bff;
            margin-right: 8px;
            line-height: 1;
        }

        /* ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãƒªã‚¹ãƒˆ */
        .filter-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .filter-list li {
            padding: 2px 0;
        }
        .filter-list a {
            display: block;
            padding: 4px 10px;
            border-radius: 4px;
            color: #333;
            text-decoration: none;
            transition: background-color 0.2s;
        }
        .filter-list a:hover {
            background-color: #eef;
        }
        .filter-list a.active {
            background-color: #007bff;
            color: white;
            font-weight: 700;
        }
        
        /* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ»ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */
        #main-content {
            min-height: 50vh;
        }
        
        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
        @media (max-width: 1024px) {
            .verb-card {
                padding: 20px;
            }
            .sidebar {
                border-right: none !important;
                border-bottom: 1px solid #ddd;
                padding-bottom: 20px;
            }
            .grid-cols-4 {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body class="p-4 sm:p-6 lg:p-8">

    <header class="text-center mb-10">
        <h1 class="text-3xl font-bold text-gray-800">ãƒ‰ã‚¤ãƒ„èªå‹•è©è¾æ›¸</h1>
        <p class="text-gray-500 mt-2">æ¥é ­è¾ã¨åŸºå¹¹ã«åŸºã¥ã„ãŸãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãƒ“ãƒ¥ãƒ¼ã‚¢</p>
    </header>

    <div id="app-container" class="grid grid-cols-1 lg:grid-cols-4 gap-8">
        
        <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ (ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°) -->
        <aside class="sidebar lg:col-span-1 bg-white p-6 rounded-lg shadow-lg border-r border-gray-200">
            <h2 class="text-xl font-semibold mb-4 border-b pb-2 text-gray-700">ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°</h2>
            
            <div class="mb-6">
                <h3 class="text-lg font-medium mb-2 text-gray-600">æ¥é ­è¾ (Prefix)</h3>
                <ul id="prefix-list" class="filter-list text-sm">
                    <!-- æ¥é ­è¾ãƒªã‚¹ãƒˆãŒã“ã“ã«æŒ¿å…¥ã•ã‚Œã¾ã™ -->
                </ul>
            </div>

            <div>
                <h3 class="text-lg font-medium mb-2 text-gray-600">åŸºå¹¹ (Stem)</h3>
                <ul id="stem-list" class="filter-list text-sm">
                    <!-- åŸºå¹¹ãƒªã‚¹ãƒˆãŒã“ã“ã«æŒ¿å…¥ã•ã‚Œã¾ã™ -->
                </ul>
            </div>
        </aside>

        <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ (å˜èªè©³ç´°) -->
        <main id="main-content" class="lg:col-span-3">
            <h2 class="text-2xl font-semibold mb-6 text-gray-800">å˜èªä¸€è¦§ï¼ˆæ¥é ­è¾ï¼šå…¨ã¦ï¼‰</h2>
            <div id="verb-details">
                <p class="text-center text-gray-500 mt-10">ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­ã§ã™...</p>
            </div>
        </main>
    </div>

    <script>
        // ----------------------------------------------------
        // JavaScript ãƒ­ã‚¸ãƒƒã‚¯ (script.js ã®å†…å®¹ã‚’çµ±åˆ)
        // ----------------------------------------------------
        
        // GASã®ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªURLã‚’ã“ã“ã«è¨­å®š
        const JSON_URL = 'https://raw.githubusercontent.com/SallyYamamoto/Prefix_German/refs/heads/main/verbs.json';
        let allData = []; // å…¨ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒã™ã‚‹ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°

        // ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€æ•´å½¢ã™ã‚‹é–¢æ•°
        async function fetchData() {
            try {
                // ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒ“ã‚¹ (allorigins.win) ã‚’ä½¿ã£ã¦CORSã‚¨ãƒ©ãƒ¼ã‚’å›é¿ã—ã€JSONãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
                const proxyUrl = `https://api.allorigins.win/raw?url=${encodeURIComponent(JSON_URL)}`;
                
                const proxyResponse = await fetch(proxyUrl);
                const data = await proxyResponse.json(); 
                
                // JSONãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å¿…è¦ãªæƒ…å ±ã‚’æŠ½å‡ºãƒ»ãƒãƒƒãƒ”ãƒ³ã‚°
                allData = data.map(item => ({
                    // JSONã®ã‚­ãƒ¼ï¼ˆitem.å˜èªãªã©ï¼‰ã¯ã€ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®1è¡Œç›®ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã¨å®Œå…¨ã«ä¸€è‡´ã•ã›ã‚‹
                    word: item.å˜èª,
                    meaning: item.æ„å‘³,
                    stem: item.åŸºå¹¹,
                    prefix: item.æ¥é ­è¾,
                    englishTranslation: item.è‹±è¨³,
                    prefixMeaning: item.æ¥é ­è¾åŸºæœ¬æ„å‘³,
                    nuance: item.èªæ„Ÿ,
                    syntax: item.æ§‹æ–‡,
                    separability: item.åˆ†é›¢æ€§,
                    conjugation: item.æ´»ç”¨,
                    example1: item.ä¾‹æ–‡1,
                    japaneseTranslation1: item.æ—¥æœ¬èªè¨³1,
                    example2: item.ä¾‹æ–‡2,
                    japaneseTranslation2: item.æ—¥æœ¬èªè¨³2,
                    derivatives: item.æ´¾ç”Ÿèª,
                    correspondingEnglish: item.å¯¾å¿œè‹±å˜èª
                }));
                
                initializePage();

            } catch (error) {
                console.error("ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚å¤–éƒ¨ãƒ—ãƒ­ã‚­ã‚·ã¾ãŸã¯GASã®è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„:", error);
                document.getElementById('verb-details').innerHTML = '<p class="text-center text-red-600 mt-10">ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚GASã®URLã€æ¨©é™ã€ãƒ‡ãƒ—ãƒ­ã‚¤çŠ¶æ…‹ã‚’å†åº¦ç¢ºèªã—ã¦ãã ã•ã„ã€‚</p>';
            }
        }

        // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãƒªã‚¹ãƒˆï¼ˆæ¥é ­è¾ã¨åŸºå¹¹ï¼‰ã‚’åˆæœŸåŒ–ã™ã‚‹
        function initializePage() {
            // å›ºæœ‰ã®æ¥é ­è¾ã¨åŸºå¹¹ã®ãƒªã‚¹ãƒˆã‚’ä½œæˆ
            const prefixes = [...new Set(allData.map(item => item.prefix))].sort();
            const stems = [...new Set(allData.map(item => item.stem))].sort();

            renderFilterList('prefix-list', prefixes, 'prefix');
            renderFilterList('stem-list', stems, 'stem');

            // åˆæœŸè¡¨ç¤ºã¨ã—ã¦å…¨å‹•è©ã‚’è¡¨ç¤º
            renderVerbDetails(allData);
        }

        // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãƒªã‚¹ãƒˆï¼ˆULè¦ç´ ï¼‰ã‚’HTMLã«æç”»ã™ã‚‹
        function renderFilterList(elementId, items, type) {
            const listElement = document.getElementById(elementId);
            listElement.innerHTML = '';
            
            // å…¨ã¦è¡¨ç¤ºãƒªãƒ³ã‚¯ã‚’è¿½åŠ 
            const allItem = document.createElement('li');
            const allText = type === 'prefix' ? 'å…¨ã¦ã®æ¥é ­è¾' : 'å…¨ã¦ã®åŸºå¹¹';
            allItem.innerHTML = `<a href="#" data-filter-value="all" data-filter-type="${type}" class="active">**${allText}**</a>`;
            allItem.querySelector('a').addEventListener('click', (e) => filterData(e, type));
            listElement.appendChild(allItem);
            
            // å„æ¥é ­è¾/åŸºå¹¹ã®ãƒªãƒ³ã‚¯ã‚’è¿½åŠ 
            items.forEach(item => {
                if (!item || String(item).trim().length === 0) return;
                
                const listItem = document.createElement('li');
                listItem.innerHTML = `<a href="#" data-filter-value="${item}" data-filter-type="${type}">${item}</a>`;
                listItem.querySelector('a').addEventListener('click', (e) => filterData(e, type));
                listElement.appendChild(listItem);
            });
        }

        // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚’å®Ÿè¡Œã—ã€çµæœã‚’ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«è¡¨ç¤ºã™ã‚‹
        function filterData(e, type) {
            e.preventDefault(); 
            const filterValue = e.target.getAttribute('data-filter-value');
            
            let filteredData;
            const headingElement = document.getElementById('main-content').querySelector('h2');
            
            if (filterValue === 'all') {
                filteredData = allData;
                headingElement.textContent = `å˜èªä¸€è¦§ï¼ˆ${type === 'prefix' ? 'æ¥é ­è¾' : 'åŸºå¹¹'}ï¼šå…¨ã¦ï¼‰`;
            } else if (type === 'prefix') {
                filteredData = allData.filter(item => item.prefix === filterValue);
                headingElement.textContent = `å˜èªä¸€è¦§ï¼ˆæ¥é ­è¾ï¼š${filterValue}ï¼‰`;
            } else if (type === 'stem') {
                filteredData = allData.filter(item => item.stem === filterValue);
                headingElement.textContent = `å˜èªä¸€è¦§ï¼ˆåŸºå¹¹ï¼š${filterValue}ï¼‰`;
            }
            
            renderVerbDetails(filteredData);
            
            // ãƒã‚¤ãƒ©ã‚¤ãƒˆå‡¦ç†
            document.querySelectorAll('.filter-list a').forEach(a => a.classList.remove('active'));
            e.target.classList.add('active');
        }

        // å‹•è©ã®è©³ç´°ãƒªã‚¹ãƒˆã‚’HTMLã«æç”»ã™ã‚‹ (ãƒ‡ã‚¶ã‚¤ãƒ³åæ˜ æ¸ˆã¿)
        function renderVerbDetails(data) {
            const detailsElement = document.getElementById('verb-details');
            detailsElement.innerHTML = ''; 
            
            if (data.length === 0) {
                detailsElement.innerHTML = '<p class="text-center text-gray-500 mt-10">è©²å½“ã™ã‚‹å˜èªã¯è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>';
                return;
            }

            data.forEach(item => {
                const verbCard = document.createElement('div');
                verbCard.classList.add('verb-card');
                
                // ä¾‹æ–‡ 2 ã® HTML ã‚’å®‰å…¨ã«ç”Ÿæˆ
                let example2Html = '';
                if (item.example2 && String(item.example2).trim().length > 0) {
                    example2Html = `
                        <div class="example-box">
                            <div class="vertical-line"></div>
                            <div class="example-content">
                                <p class="german-sentence">${item.example2}</p>
                                <p class="japanese-translation">ï¼ˆ${item.japaneseTranslation2 || '---'}ï¼‰</p>
                            </div>
                        </div>
                    `;
                }
                
                // æ´¾ç”Ÿèªã¨å¯¾å¿œè‹±å˜èªã®HTMLã‚’ç”Ÿæˆ
                const relatedHtml = `
                    <div class="related-section">
                        ${(item.derivatives && String(item.derivatives).trim().length > 0) ? `
                            <div class="related-item">
                                <span class="icon">ğŸ”—</span>
                                <span class="detail-label">æ´¾ç”Ÿèª:</span>
                                <span class="german-term">${item.derivatives}</span>
                            </div>
                        ` : ''}
                        
                        ${(item.correspondingEnglish && String(item.correspondingEnglish).trim().length > 0) ? `
                            <div class="related-item">
                                <span class="icon">ğŸ‡¬ğŸ‡§</span>
                                <span class="detail-label">é¡ä¼¼è‹±å˜èª:</span>
                                <span class="highlight-detail">${item.correspondingEnglish}</span>
                            </div>
                        ` : ''}
                    </div>
                `;

                // å…¨ã¦ã®é …ç›®ã‚’æ–°ã—ã„ãƒ‡ã‚¶ã‚¤ãƒ³æ§‹é€ ã«åŸ‹ã‚è¾¼ã‚€
                verbCard.innerHTML = `
                    <div class="card-header">
                        <h3>${item.word}</h3>
                        <div class="etymology">${item.prefix || '---'} + ${item.stem || '---'}</div>
                    </div>

                    <div class="meaning-jp">${item.meaning}</div>
                    <div class="meaning-en">(${item.englishTranslation || '---'})</div>

                    <div class="detail-section">
                        <div class="detail-item">
                            <span class="detail-label">æ§‹æˆ:</span>
                            <span class="detail-value highlight-detail">
                                ${item.prefix || '---'}
                                ${(item.prefixMeaning && String(item.prefixMeaning).trim().length > 0) 
                                    ? `ï¼ˆ${item.prefixMeaning}ï¼‰` 
                                    : ''
                                }
                                + ${item.stem || '---'}
                            </span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">åˆ†é›¢æ€§:</span>
                            <span class="detail-value">${item.separability || '---'}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">èªæ„Ÿ:</span>
                            <span class="detail-value">${item.nuance || '---'}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">æ§‹æ–‡:</span>
                            <span class="detail-value"><span class="german-term">${item.syntax || '---'}</span></span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">æ´»ç”¨:</span>
                            <span class="detail-value"><span class="german-term">${item.conjugation || '---'}</span></span>
                        </div>
                    </div>

                    <div class="example-section">
                        <h4 class="text-lg font-medium mb-3 text-gray-700">ä¾‹æ–‡</h4>
                        <div class="example-box">
                            <div class="vertical-line"></div>
                            <div class="example-content">
                                <p class="german-sentence">${item.example1 || '---'}</p>
                                <p class="japanese-translation">ï¼ˆ${item.japaneseTranslation1 || '---'}ï¼‰</p>
                            </div>
                        </div>
                        ${example2Html}
                    </div>
                    
                    ${relatedHtml}
                `;
                detailsElement.appendChild(verbCard);
            });
        }

        // ãƒšãƒ¼ã‚¸ã®ãƒ­ãƒ¼ãƒ‰æ™‚ã«ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚’é–‹å§‹
        fetchData();
    </script>
</body>
</html>
